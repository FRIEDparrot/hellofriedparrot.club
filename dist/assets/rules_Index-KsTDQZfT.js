import{R as N,o as O}from"./RulesLayout-BYCViV72.js";import{j as F,R as M,h as S,d as E,_ as H,r as s,c as h,o as l,m as g,a as o,w as t,f as _,t as d,F as P,q as U,e as m,K as j,b as u}from"./index-CqgRRlZL.js";import{r as z,g as D}from"./MarkdownUtils-BblUo5Ac.js";import{n as W}from"./navbar_simple-4sphbzQO.js";import{f as I}from"./footerbar_common-DQihSBHW.js";import{f as K,s as q}from"./showFloatingAlert-CI_PrnNs.js";import{L as x,M as J}from"./markdownOutline-Dah2bIIM.js";import"./index-BbAoIb73.js";import"./toString-CyGcNvj-.js";import"./isSymbol-C7jn4vLP.js";import"./translateBtn-BRuTLF4g.js";import"./homeBtn-BOzY3PSi.js";class V{static async getRuleList(){const n=F();return M(()=>S.get("/rules/",{params:{lang:n}}))}static async getRuleContent(n){const r=F(),i="/rules/"+n,p={lang:r};return M(()=>S.get(i,{params:p}))}}const G=E({name:"markdownFileListView",components:{},props:{header:{type:String,default:""},base_url:{type:String,default:"rules"},directory:{type:Object,default:()=>({})}},data(){return{BaseUrl:""}},mounted(){let e=this.base_url;e.endsWith("/")&&(e=e.slice(0,-1)),e.startsWith("/")&&(e=e.slice(1)),this.BaseUrl=e},methods:{handleClick(e,n){e.ctrlKey||e.metaKey?window.open("/"+this.BaseUrl+"/"+n,"_blank"):window.open("/"+this.BaseUrl+"/"+n,"_self")}},computed:{}}),Q={key:0};function X(e,n,r,i,p,A){const C=s("v-btn"),v=s("v-toolbar-title"),y=s("v-spacer"),w=s("v-toolbar"),k=s("v-divider"),b=s("v-icon"),$=s("v-list-item-title"),L=s("v-list-item"),R=s("markdownFileListView",!0),T=s("v-list-group"),B=s("v-list");return l(),h(P,null,[e.header!==""?(l(),h("div",Q,[o(w,{class:"bg-sidebar_heading_deep",height:"55px",width:"100%"},{default:t(()=>[o(C,{icon:"mdi-view-dashboard",size:"55px",style:{"margin-right":"0px"}}),o(v,{style:{"font-size":"larger"}},{default:t(()=>[_(d(e.header),1)]),_:1}),o(y)]),_:1}),o(k)])):g("",!0),o(B,{dense:"",class:"file-list-view"},{default:t(()=>[(l(!0),h(P,null,U(e.directory,(a,c)=>(l(),h("div",{key:c},[a.type==="file"?(l(),m(L,{key:0,class:"sidebar-item",onClick:f=>e.handleClick(f,a.url),dense:""},{prepend:t(()=>[a.icon!=null?(l(),m(b,{key:0},{default:t(()=>[_(d(a.icon),1)]),_:2},1024)):(l(),m(b,{key:1,color:"gray"},{default:t(()=>n[0]||(n[0]=[_(d("mdi-file-document"))])),_:1}))]),default:t(()=>[o($,{class:"ml-2"},{default:t(()=>[_(d(a.t),1)]),_:2},1024)]),_:2},1032,["onClick"])):g("",!0),a.type==="folder"?(l(),m(T,{key:1,class:"sidebar-list"},{activator:t(({props:f})=>[o(L,j({color:"list_selected",ref_for:!0},f,{title:a.t,"prepend-icon":"mdi-dots-vertical"}),null,16,["title"])]),default:t(()=>[o(R,{directory:a.d,header:""},null,8,["directory"])]),_:2},1024)):g("",!0)]))),128))]),_:1})],64)}const Y=H(G,[["render",X],["__scopeId","data-v-8c0e4e5e"]]),Z=E({name:"RulesIndex",components:{NavbarSimple:W,RulesLayout:N,footerbar:I,FloatingAlert:K,markdownFileListView:Y,MarkdownOutline:J,LeftSideBarBtnContent:x},props:["file_path"],data(){return{directory:{},menuOpen:!1,headings:[],loading_rules:!0,renderHTML:""}},computed:{},methods:{setCookies(){this.$refs.cookiePrompt.setCookies()},async renderRulesDirectory(){var e,n;try{const i=(await V.getRuleList()).data;if(!i)throw new Error(this.$t("rules.noRulesFound"));this.directory=JSON.parse(i)}catch(r){console.error(r),r instanceof SyntaxError?this.showErrorAlert(this.$t("g.JsonParseError")):this.showErrorAlert((((n=(e=r.response)==null?void 0:e.data)==null?void 0:n.message)||r.message)??this.$t("g.UnknownError"))}},async getRulesContent(){var e,n;{let r="";this.loading_rules=!0;try{const i=this.file_path??"index";r=(await V.getRuleContent(i)).data}catch(i){this.loading_rules=!1;const p="<h2>"+this.$t("rules.loadFailed")+"</h2><h3><p>"+((((n=(e=i.response)==null?void 0:e.data)==null?void 0:n.message)||i.message)??this.$t("g.UnknownError"))+"</p></h3>";return Promise.reject(p)}return this.loading_rules=!1,Promise.resolve(r)}},showErrorAlert(e){q(this.$refs.alertBox,!1,e)},scrollToTitle(){O(this.headings.map(e=>e.id))}},mounted(){this.renderRulesDirectory(),this.getRulesContent().then(e=>{this.renderHTML=z(e,!0),this.headings=D(this.renderHTML)}).catch(e=>{this.renderHTML=e}).finally(()=>window.addEventListener("scroll",this.scrollToTitle))},beforeDestroy(){window.removeEventListener("scroll",this.scrollToTitle)}}),ee={class:"rules-collection"},te={class:"bg-background_smooth rules-content-container"},oe={style:{width:"100%","align-items":"center","justify-content":"center",display:"flex","text-align":"center"}},se={class:"left-sidebar-fileView"},ne=["innerHTML"],re={class:"rules-footer-bar-container"};function ie(e,n,r,i,p,A){const C=s("NavbarSimple"),v=s("v-icon"),y=s("v-list-item"),w=s("markdownFileListView"),k=s("MarkdownOutline"),b=s("LeftSideBarBtnContent"),$=s("v-card"),L=s("v-responsive"),R=s("v-skeleton-loader"),T=s("footerbar"),B=s("RulesLayout"),a=s("FloatingAlert");return l(),h(P,null,[u("div",ee,[o(B,null,{navbar:t(()=>[o(C,{hideLeftToggleWidth:1400},{title:t(()=>[_(d(e.$t("rules.title")),1)]),_:1})]),"left-sidebar":t(()=>[o(b,{ref:"leftSideBar"},{btnContainer:t(({select:c})=>[o(y,{class:"rules-list-item",value:"filePanel",onClick:f=>c(0)},{default:t(()=>[o(v,{size:"30"},{default:t(()=>n[0]||(n[0]=[_(d("mdi-view-dashboard"))])),_:1})]),_:2},1032,["onClick"]),o(y,{class:"rules-list-item",value:"contentPanel",onClick:f=>c(1)},{default:t(()=>[o(v,{size:"30"},{default:t(()=>n[1]||(n[1]=[_(d("mdi-table-of-contents"))])),_:1})]),_:2},1032,["onClick"])]),contentPanel:t(({selected:c})=>[c===0?(l(),m(w,{key:0,base_url:"rules",header:e.$t("rules.listTitle"),directory:e.directory},null,8,["header","directory"])):g("",!0),c===1?(l(),m(k,{key:1,title:e.$t("g.outline"),titleClass:"bg-sidebar_heading_deep",headings:e.headings,scrollOffset:0},null,8,["title","headings"])):g("",!0),n[2]||(n[2]=u("div",{class:"left-sidebar-outlineView"},null,-1))]),_:1},512)]),"folder-panel":t(()=>[o(w,{base_url:"rules",header:e.$t("rules.listTitle"),directory:e.directory},null,8,["header","directory"])]),outliner:t(()=>[o(k,{title:e.$t("g.outline"),headings:e.headings,scrollOffset:-30,style:{"z-index":"5"}},null,8,["title","headings"])]),main:t(()=>[o(R,{width:"90%",height:"100%",loading:e.loading_rules,type:"table-heading, list-item-two-line, article, list-item-two-line, article",elevation:"2"},{default:t(()=>[u("div",te,[u("div",oe,[o($,{variant:"outlined",width:"80%"},{default:t(()=>[u("div",se," âš "+d(e.$t("rules.thisWebRulesUpdating")),1)]),_:1})]),o(L,null,{default:t(()=>[u("div",{innerHTML:e.renderHTML},null,8,ne)]),_:1})])]),_:1},8,["loading"])]),footer:t(()=>[u("div",re,[o(T)])]),_:1})]),o(a,{ref:"alertBox"},null,512)],64)}const ye=H(Z,[["render",ie]]);export{ye as default};
